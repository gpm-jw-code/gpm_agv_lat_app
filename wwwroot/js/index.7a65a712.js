(function(){var e={6700:function(e,t,a){var s={"./af":3906,"./af.js":3906,"./ar":902,"./ar-dz":3853,"./ar-dz.js":3853,"./ar-kw":299,"./ar-kw.js":299,"./ar-ly":6825,"./ar-ly.js":6825,"./ar-ma":6379,"./ar-ma.js":6379,"./ar-sa":7700,"./ar-sa.js":7700,"./ar-tn":2059,"./ar-tn.js":2059,"./ar.js":902,"./az":6043,"./az.js":6043,"./be":7936,"./be.js":7936,"./bg":4078,"./bg.js":4078,"./bm":4014,"./bm.js":4014,"./bn":9554,"./bn-bd":7114,"./bn-bd.js":7114,"./bn.js":9554,"./bo":6529,"./bo.js":6529,"./br":5437,"./br.js":5437,"./bs":9647,"./bs.js":9647,"./ca":9951,"./ca.js":9951,"./cs":6113,"./cs.js":6113,"./cv":7965,"./cv.js":7965,"./cy":5858,"./cy.js":5858,"./da":3515,"./da.js":3515,"./de":2831,"./de-at":6263,"./de-at.js":6263,"./de-ch":1127,"./de-ch.js":1127,"./de.js":2831,"./dv":4510,"./dv.js":4510,"./el":8616,"./el.js":8616,"./en-au":4595,"./en-au.js":4595,"./en-ca":3545,"./en-ca.js":3545,"./en-gb":9609,"./en-gb.js":9609,"./en-ie":3727,"./en-ie.js":3727,"./en-il":3302,"./en-il.js":3302,"./en-in":6305,"./en-in.js":6305,"./en-nz":9128,"./en-nz.js":9128,"./en-sg":4569,"./en-sg.js":4569,"./eo":650,"./eo.js":650,"./es":6358,"./es-do":4214,"./es-do.js":4214,"./es-mx":8639,"./es-mx.js":8639,"./es-us":232,"./es-us.js":232,"./es.js":6358,"./et":7279,"./et.js":7279,"./eu":5515,"./eu.js":5515,"./fa":7981,"./fa.js":7981,"./fi":7090,"./fi.js":7090,"./fil":9208,"./fil.js":9208,"./fo":2799,"./fo.js":2799,"./fr":3463,"./fr-ca":2213,"./fr-ca.js":2213,"./fr-ch":2848,"./fr-ch.js":2848,"./fr.js":3463,"./fy":1468,"./fy.js":1468,"./ga":8163,"./ga.js":8163,"./gd":2898,"./gd.js":2898,"./gl":6312,"./gl.js":6312,"./gom-deva":682,"./gom-deva.js":682,"./gom-latn":9178,"./gom-latn.js":9178,"./gu":5009,"./gu.js":5009,"./he":2795,"./he.js":2795,"./hi":7009,"./hi.js":7009,"./hr":6506,"./hr.js":6506,"./hu":9565,"./hu.js":9565,"./hy-am":3864,"./hy-am.js":3864,"./id":5626,"./id.js":5626,"./is":6649,"./is.js":6649,"./it":151,"./it-ch":5348,"./it-ch.js":5348,"./it.js":151,"./ja":9830,"./ja.js":9830,"./jv":3751,"./jv.js":3751,"./ka":3365,"./ka.js":3365,"./kk":5980,"./kk.js":5980,"./km":9571,"./km.js":9571,"./kn":5880,"./kn.js":5880,"./ko":6809,"./ko.js":6809,"./ku":6773,"./ku.js":6773,"./ky":5505,"./ky.js":5505,"./lb":553,"./lb.js":553,"./lo":1237,"./lo.js":1237,"./lt":1563,"./lt.js":1563,"./lv":1057,"./lv.js":1057,"./me":6495,"./me.js":6495,"./mi":3096,"./mi.js":3096,"./mk":3874,"./mk.js":3874,"./ml":6055,"./ml.js":6055,"./mn":7747,"./mn.js":7747,"./mr":7113,"./mr.js":7113,"./ms":8687,"./ms-my":7948,"./ms-my.js":7948,"./ms.js":8687,"./mt":4532,"./mt.js":4532,"./my":4655,"./my.js":4655,"./nb":6961,"./nb.js":6961,"./ne":2512,"./ne.js":2512,"./nl":8448,"./nl-be":2936,"./nl-be.js":2936,"./nl.js":8448,"./nn":9031,"./nn.js":9031,"./oc-lnc":5174,"./oc-lnc.js":5174,"./pa-in":118,"./pa-in.js":118,"./pl":3448,"./pl.js":3448,"./pt":3518,"./pt-br":2447,"./pt-br.js":2447,"./pt.js":3518,"./ro":817,"./ro.js":817,"./ru":262,"./ru.js":262,"./sd":8990,"./sd.js":8990,"./se":3842,"./se.js":3842,"./si":7711,"./si.js":7711,"./sk":756,"./sk.js":756,"./sl":3772,"./sl.js":3772,"./sq":6187,"./sq.js":6187,"./sr":732,"./sr-cyrl":5713,"./sr-cyrl.js":5713,"./sr.js":732,"./ss":9455,"./ss.js":9455,"./sv":9770,"./sv.js":9770,"./sw":959,"./sw.js":959,"./ta":6459,"./ta.js":6459,"./te":5302,"./te.js":5302,"./tet":7975,"./tet.js":7975,"./tg":1294,"./tg.js":1294,"./th":2385,"./th.js":2385,"./tk":4613,"./tk.js":4613,"./tl-ph":8668,"./tl-ph.js":8668,"./tlh":8190,"./tlh.js":8190,"./tr":4506,"./tr.js":4506,"./tzl":3440,"./tzl.js":3440,"./tzm":9852,"./tzm-latn":2350,"./tzm-latn.js":2350,"./tzm.js":9852,"./ug-cn":730,"./ug-cn.js":730,"./uk":99,"./uk.js":99,"./ur":2100,"./ur.js":2100,"./uz":6002,"./uz-latn":6322,"./uz-latn.js":6322,"./uz.js":6002,"./vi":4207,"./vi.js":4207,"./x-pseudo":4674,"./x-pseudo.js":4674,"./yo":570,"./yo.js":570,"./zh-cn":3644,"./zh-cn.js":3644,"./zh-hk":2591,"./zh-hk.js":2591,"./zh-mo":9503,"./zh-mo.js":9503,"./zh-tw":8080,"./zh-tw.js":8080};function n(e){var t=r(e);return a(t)}function r(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=r,e.exports=n,n.id=6700},4285:function(e,t,a){"use strict";var s=a(9242),n=a(3396);const r={class:"navbar navbar-expand-sm navbar-dark bg-dark fixed-top"},o={class:"container-fluid"},l=(0,n._)("a",{class:"navbar-brand",href:"#"},"GPM",-1),i={class:"navbar-toggler",type:"button"},c=(0,n._)("span",{class:"navbar-toggler-icon"},null,-1),d=[c],u=(0,n.uE)('<div class="collapse navbar-collapse" id="navbarID"><div class="navbar-nav"><a class="nav-link active" aria-current="page" href="/">Home</a><a class="nav-link active" aria-current="page" href="/Orders">Orders</a><a class="nav-link active" aria-current="page" href="/agvc">車庫</a><a class="nav-link active" aria-current="page" href="/log">Log</a></div></div>',1);function g(e,t){const a=(0,n.up)("el-backtop"),s=(0,n.up)("router-view"),c=(0,n.Q2)("b-toggle");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(a,{right:40,bottom:40}),(0,n._)("nav",r,[(0,n._)("div",o,[l,(0,n.wy)(((0,n.wg)(),(0,n.iD)("button",i,d)),[[c,void 0,void 0,{navbarID:!0}]]),u])]),(0,n.Wm)(s,{style:{height:"100%","padding-top":"30px"}})],64)}var m=a(89);const v={},p=(0,m.Z)(v,[["render",g]]);var h=p,f=a(5431);(0,f.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var w=a(2483);const _={class:"home"};function b(e,t,a,s,r,o){const l=(0,n.up)("AGVSSettingVue"),i=(0,n.up)("AGVCTableVue");return(0,n.wg)(),(0,n.iD)("div",_,[(0,n.Wm)(l),(0,n.Wm)(i,{states:e.agvcStatus},null,8,["states"])])}const y={class:"agvs-setting block-item border-bottom"},k=(0,n._)("h3",null,"AGVS 設定",-1);function j(e,t,a,s,r,o){const l=(0,n.up)("AGVSItemVue");return(0,n.wg)(),(0,n.iD)("div",y,[k,(0,n.Wm)(l,{agvsProps:r.agvsSettings},null,8,["agvsProps"])])}var S=a(6265),D=a.n(S),C="http://localhost:5279";async function O(){return await T("/api/agvc/list")}async function x(){return await T("/api/agvc/states")}async function A(e){return await T(`/api/agvc/state?agvc_id=${e}`)}async function W(){return await T("/api/agvs/settings")}async function I(){return await T("/api/agvc/AgvTypes")}async function z(){return await T("/api/Orders")}async function T(e){var t=await D().get(e);return t.data}D().defaults.baseURL=C;var V=a(7139);const N={class:"agvs-item d-flex flex-row my-2 mx-2"},L={class:"d-flex flex-row"},G=(0,n._)("span",null,"Provider",-1),F={class:"mx-3"},U={class:"d-flex flex-row"},P=(0,n._)("span",null,"Connection",-1),H={class:"mx-3"};function E(e,t,a,s,r,o){const l=(0,n.up)("el-tag");return(0,n.wg)(),(0,n.iD)("div",N,[(0,n._)("div",L,[G,(0,n._)("div",F,[(0,n.Wm)(l,{round:"",effect:"dark",size:"large"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(a.agvsProps.VenderName),1)])),_:1})])]),(0,n._)("div",U,[P,(0,n._)("div",H,[(0,n.Wm)(l,{round:"",effect:"dark",size:"large"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(a.agvsProps.ConnectionString),1)])),_:1})])])])}var M={props:{agvsProps:{type:Object,default(){return{VenderName:"",ConnectionString:""}}}}};const $=(0,m.Z)(M,[["render",E]]);var R=$,q={components:{AGVSItemVue:R},data(){return{agvsSettings:{VenderName:"",ConnectionString:""}}},mounted(){setTimeout((async()=>{this.agvsSettings=await W()}),100)}};const K=(0,m.Z)(q,[["render",j]]);var Z=K;const B={class:"agvc-table block-item border-bottom"},Q=(0,n._)("h3",null,"AGVC 列表",-1),Y=(0,n.Uk)("詳細內容"),J=(0,n.Uk)("MAP");function X(e,t,a,s,r,o){const l=(0,n.up)("el-table-column"),i=(0,n.up)("el-tag"),c=(0,n.up)("el-progress"),d=(0,n.up)("el-button"),u=(0,n.up)("el-table"),g=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.iD)("div",B,[Q,(0,n.wy)(((0,n.wg)(),(0,n.j4)(u,{data:r.agvcStatus,"row-key":"agvcParameters.tcpParams.hostIP","header-cell-style":r.header_style},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{label:"ID",prop:"ID"}),(0,n.Wm)(l,{label:"AGVC Name",prop:"EQName"}),(0,n.Wm)(l,{label:"Connection"},{default:(0,n.w5)((e=>[(0,n._)("div",null,(0,V.zw)(e.row.agvcParameters.tcpParams.HostIP)+":"+(0,V.zw)(e.row.agvcParameters.tcpParams.HostPort),1)])),_:1}),(0,n.Wm)(l,{label:"Type",prop:"agvcType",formatter:o.TypeFormatter},null,8,["formatter"]),(0,n.Wm)(l,{label:"連線狀態",prop:"agvcStates.States.EConnectionState"},{default:(0,n.w5)((e=>[(0,n.Wm)(i,{effect:"plain",type:0==e.row.agvcStates.States.EConnectionState?"success":"warning"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(o.ConnectionStateFormatter(e.row.agvcStates.States.EConnectionState)),1)])),_:2},1032,["type"])])),_:1}),(0,n.Wm)(l,{label:"上線狀態",prop:"agvcStates.States.OnlineState"}),(0,n.Wm)(l,{label:"工作狀態",prop:"agvcStates.States.ERunningState",formatter:o.RunningStateFormatter},null,8,["formatter"]),(0,n.Wm)(l,{label:"電量"},{default:(0,n.w5)((e=>[(0,n.Wm)(c,{type:"circle",width:45,percentage:e.row.agvcStates.BetteryState.remaining},null,8,["percentage"])])),_:1}),(0,n.Wm)(l,{width:"200"},{default:(0,n.w5)((e=>[(0,n.Wm)(d,{onClick:t=>o.ShowAGVCInfoPage(e.row)},{default:(0,n.w5)((()=>[Y])),_:2},1032,["onClick"]),(0,n.Wm)(d,{onClick:t=>o.ShowMapButtonHandle(e.row)},{default:(0,n.w5)((()=>[J])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","header-cell-style"])),[[g,r.tableLoading]])])}function ee(e){return 0==e?"GPM推高機":1==e?"罡豪潛遁":"Unknown"}function te(e){return 0==e?"GPM":1==e?"晶潔能AGVS":"Unknown"}function ae(e){return 0==e?"Connected":1==e?"Connecting":"Disconnect"}function se(e){return 0==e?"Idle":"Running"}function ne(e){return 0==e?"WAIT_EXECUTE":1==e?"EXECUTING":2==e?"COMPLETE":3==e?"STOPPED":4==e?"FAILED":5==e?"ERROR":"Unknown"}var re={data(){return{tableLoading:!0,agvcStatus:[],header_style:{backgroundColor:"black",color:"white"}}},methods:{TypeFormatter(e,t,a,s){return ee(a)},ConnectionStateFormatter(e){return ae(e)},RunningStateFormatter(e,t,a,s){return se(a)},BetteryStateFormatter(e,t,a,s){return a+" %"},ShowAGVCInfoPage(e){this.$router.push({name:"agvc",query:{agv_id:e.ID}})},ShowMapButtonHandle(e){console.info(e),this.$router.push({name:"map",params:{agv_id:e.ID}})}},mounted(){setTimeout((async()=>{setInterval((async()=>{this.agvcStatus=await x(),this.tableLoading=!1}),1e3)}),10)}};const oe=(0,m.Z)(re,[["render",X]]);var le=oe,ie={name:"HomeView",components:{AGVSSettingVue:Z,AGVCTableVue:le},data(){return{}}};const ce=(0,m.Z)(ie,[["render",b]]);var de=ce;const ue={class:"agvc-map block-item h-100"},ge={class:"d-flex flex-row"},me={class:"flex-fill"},ve=(0,n.Uk)(" MAP OF AGV- "),pe={class:"text-end"},he={class:"text-end"},fe=(0,n.Uk)("顯示所有AGV"),we={class:"map-display border-top bg-dark",style:{height:"800px"}},_e={class:"popover-content"},be={class:"d-flex flex-row"},ye=(0,n._)("span",null,"ID",-1),ke={class:"d-flex flex-row"},je=(0,n._)("span",null,"Brand",-1),Se={class:"d-flex flex-row"},De=(0,n._)("span",null,"操作模式",-1),Ce={class:"d-flex flex-row"},Oe=(0,n._)("span",null,"上線狀態",-1),xe={class:"d-flex flex-row"},Ae=(0,n._)("span",null,[(0,n.Uk)(" 電量 "),(0,n._)("i",{class:"bi bi-battery"})],-1),We={class:"global-coordinate-display"};function Ie(e,t,a,s,r,o){const l=(0,n.up)("el-option"),i=(0,n.up)("el-select"),c=(0,n.up)("el-button"),d=(0,n.up)("el-tag"),u=(0,n.up)("el-progress"),g=(0,n.up)("el-popover");return(0,n.wg)(),(0,n.iD)("div",ue,[(0,n._)("div",ge,[(0,n._)("h3",me,[ve,(0,n.Wm)(i,{size:"large",modelValue:r.selectedID,"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedID=e)},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.AGVCTypesInfo,((e,t)=>((0,n.wg)(),(0,n.j4)(l,{key:t,value:t,label:t},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])]),(0,n._)("span",pe,(0,V.zw)(o.hostUrl),1),(0,n._)("span",he,["single-agv"==o.displayMode?((0,n.wg)(),(0,n.j4)(c,{key:0,onClick:o.ShowAllAgvMode},{default:(0,n.w5)((()=>[fe])),_:1},8,["onClick"])):(0,n.kq)("",!0)])]),(0,n._)("div",we,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.RecievedData,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{class:"agv-spot d-flex flex-column",key:t,style:(0,V.j5)(r.agvSpotStyle[t].position)},[(0,n.Wm)(g,{placement:"top-start",width:"200px"},{reference:(0,n.w5)((()=>[(0,n._)("span",null,(0,V.zw)(t),1)])),default:(0,n.w5)((()=>[(0,n._)("div",_e,[(0,n._)("div",be,[ye,(0,n._)("div",null,(0,V.zw)(t),1)]),(0,n._)("div",ke,[je,(0,n._)("div",null,(0,V.zw)(r.AGVCTypesInfo[t]),1)]),(0,n._)("div",Se,[De,(0,n._)("div",null,(0,V.zw)(e.States.OperationState),1)]),(0,n._)("div",Ce,[Oe,(0,n._)("div",null,[(0,n.Wm)(d,{effect:"dark",type:"OFFLINE"==e.States.OnlineState?"danger":"success"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(e.States.OnlineState),1)])),_:2},1032,["type"])])]),(0,n._)("div",xe,[Ae,(0,n._)("div",null,[(0,n.Wm)(u,{"text-inside":!0,"stroke-width":26,percentage:e.BetteryState.remaining},null,8,["percentage"])])])])])),_:2},1024),(0,n._)("i",{style:(0,V.j5)(r.agvSpotStyle[t].rotation),class:(0,V.C_)([[e.States.RunningState],"direction-indicator bi bi-arrow-up-circle"])},null,6),(0,n._)("div",We,"("+(0,V.zw)(e.MapStates.globalCoordinate.x)+","+(0,V.zw)(e.MapStates.globalCoordinate.y)+","+(0,V.zw)(e.MapStates.globalCoordinate.r)+")",1)],4)))),128))])])}var ze={data(){return{websocket:null,websocketConnected:!1,RecievedData:{},agvSpotStyle:{},selectedID:"",AGVCTypesInfo:{}}},computed:{agv_id(){return void 0==this.$route.params.agv_id?"all":this.$route.params.agv_id},hostUrl(){return C.replace("http","ws")},displayMode(){return void 0==this.$route.params.agv_id?"all-agvs":"single-agv"}},methods:{WebsocketIni(){this.websocket=new WebSocket(`${this.hostUrl}/map?agv_id=${this.agv_id}`),this.websocket.onopen=()=>{this.websocketConnected=!0},this.websocket.onmessage=e=>this.HandleWSData(e)},HandleWSData(e){this.RecievedData=JSON.parse(e.data),Object.keys(this.RecievedData).forEach((e=>{var t=this.RecievedData[e].MapStates.globalCoordinate;void 0==this.agvSpotStyle[e]&&(this.agvSpotStyle[e]={position:{},rotation:{}}),this.agvSpotStyle[e].position.top=t.x+"px",this.agvSpotStyle[e].position.left=t.y+"px",this.agvSpotStyle[e].rotation.transform=`rotateZ(${t.r}deg)`})),this.afvSpotStyle},ShowAllAgvMode(){location.href="/map_all"}},mounted(){this.selectedID=this.agv_id,I().then((e=>{this.AGVCTypesInfo=e,this.WebsocketIni()}))}};const Te=(0,m.Z)(ze,[["render",Ie]]);var Ve=Te;const Ne={class:"d-flex flex-row h-100"},Le=(0,n._)("div",{class:"border-bottom w-100 mb-3"},[(0,n._)("h3",null,"Order List")],-1),Ge=(0,n.Uk)(" 訂單接收時間 "),Fe=(0,n._)("i",{class:"bi bi-question-circle"},null,-1),Ue={class:"w-100"},Pe=(0,n.Uk)("Order 內容"),He={class:"block-item h-100 task-data-view-container border-left"},Ee={class:"d-flex flex-row"},Me=(0,n._)("i",{class:"bi bi-chevron-double-right"},null,-1),$e=(0,n._)("h3",{class:"mx-2"},"Task Data",-1),Re=(0,n._)("span",{class:"title"},"LAT Format",-1),qe={class:"card-header d-flex flex-row w-100"},Ke={class:"text-start flex-fill"},Ze=(0,n._)("span",{class:"title"},"From AGVS",-1),Be={class:"card-header d-flex flex-row w-100"},Qe={class:"text-start flex-fill"};function Ye(e,t,a,r,o,l){const i=(0,n.up)("el-table-column"),c=(0,n.up)("el-tag"),d=(0,n.up)("el-popover"),u=(0,n.up)("el-button"),g=(0,n.up)("el-table"),m=(0,n.up)("json-viewer"),v=(0,n.up)("el-card");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",Ne,[(0,n._)("div",{class:(0,V.C_)(["table-container block-item",o.show_task_data?"table-mini":"table-full"])},[Le,(0,n.Wm)(g,{"row-key":"OrderNo",data:o.OrderList,"highlight-current-row":""},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{label:"NO",prop:"OrderNo",width:60,fixed:"left"}),(0,n.Wm)(i,{label:"任務名",prop:"latOrderDetail.taskName",width:120,fixed:"left"}),(0,n.Wm)(i,{label:"訂單狀態",prop:"State",formatter:l.StateFormatter},null,8,["formatter"]),(0,n.Wm)(i,{label:"訂單需求廠商(派車)",prop:"FromAGVS.agvsType"},{default:(0,n.w5)((e=>[void 0!=e.row.FromAGVS?((0,n.wg)(),(0,n.j4)(c,{key:0,style:{cursor:"pointer"},type:"danger",size:"normal",effect:"plain"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(l.AGVSProviderFormatter(e.row.FromAGVS.agvsType)),1)])),_:2},1024)):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(i,{label:"訂單接收時間",prop:"RecieveTimeStamp",formatter:l.TimeFormatter},{header:(0,n.w5)((()=>[Ge,(0,n.Wm)(d,{content:"LAT平台接收到派車任務的時間戳",placement:"top-start"},{reference:(0,n.w5)((()=>[Fe])),_:1})])),_:1},8,["formatter"]),(0,n.Wm)(i,{label:"執行訂單的AGVC",prop:"ExecuteingAGVC"},{default:(0,n.w5)((e=>[(0,n._)("div",Ue,[(0,n.Wm)(c,{class:"w-100",style:{cursor:"pointer"},effect:"plain",onClick:t=>l.AgvcTagClickHandle(e.row.ExecuteingAGVC.agvcID)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(l.ExecuteAGVCInfoFormatter(e.row.ExecuteingAGVC)),1)])),_:2},1032,["onClick"])])])),_:1}),(0,n.Wm)(i,{label:"訂單完成時間",prop:"CompleteTimeStamp",formatter:l.TimeFormatter},null,8,["formatter"]),(0,n.Wm)(i,{fixed:"right"},{default:(0,n.w5)((e=>[(0,n.Wm)(u,{onClick:t=>l.ShowOrderBtnClickHandle(e.row)},{default:(0,n.w5)((()=>[Pe])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])],2),(0,n.wy)((0,n._)("div",He,[(0,n._)("div",Ee,[(0,n.Wm)(u,{circle:"",onClick:t[0]||(t[0]=e=>o.show_task_data=!1)},{default:(0,n.w5)((()=>[Me])),_:1}),$e]),Re,(0,n.Wm)(v,{style:{height:"400px","overflow-y":"scroll"}},{header:(0,n.w5)((()=>[(0,n._)("div",qe,[(0,n._)("span",Ke,"Order-"+(0,V.zw)(o.SelectOrderNO),1)])])),default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"text-start",value:l.SelectedOrderTaskData_LAT,"expand-depth":4,copyable:"",boxed:"",expanded:""},null,8,["value"])])),_:1}),Ze,(0,n.Wm)(v,{style:{height:"400px","overflow-y":"scroll"}},{header:(0,n.w5)((()=>[(0,n._)("div",Be,[(0,n._)("span",Qe,"Order-"+(0,V.zw)(o.SelectOrderNO),1)])])),default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"text-start",value:l.SelectedOrderTaskData,"expand-depth":4,copyable:"",boxed:"",expanded:""},null,8,["value"])])),_:1})],512),[[s.F8,o.show_task_data]])])])}var Je=a(6797),Xe=a.n(Je),et={data(){return{OrderList:[{OrderNo:1,TaskDownloadData:{SID:"001:001:001",EQName:"AGV_001",Header:{"0301":{"Time Stamp":"20220831 12:00:01",test:12.33}}}},{OrderNo:2,TaskDownloadData:{}}],show_task_data:!0,SelectOrderNO:-1,websocket:null}},methods:{ShowOrderBtnClickHandle(e){this.show_task_data?this.show_task_data=this.SelectOrderNO!=e.OrderNo:this.show_task_data=!0,this.SelectOrderNO=e.OrderNo},async FetchOrderList(){this.OrderList=await z()},SubscribeOrderChange(){this.websocket=new WebSocket("ws://localhost:5279/order"),this.websocket.onmessage=e=>{var t=JSON.parse(e.data),a=this.OrderList.find((e=>e.OrderNo==t.OrderNo));a?this.UpdateOrder(t):this.OrderList.push(t)},this.websocket.onopen=()=>console.info("[/order] ws connected")},UpdateOrder(e){var t=this.OrderList.findIndex((t=>t.OrderNo==e.OrderNo));this.OrderList[t]=e},TimeFormatter(e,t,a,s){return Xe()(a).format("yyyy-MM-DD HH:mm:ss")},AGVSProviderFormatter(e){return te(e)},StateFormatter(e,t,a,s){return 0==a?"等待訂單接收":1==a?"訂單執行中":2==a?"訂單已完成":"Unknown"},ExecuteAGVCInfoFormatter(e){return void 0==e?"":`${e.agvcID}(${ee(e.agvcType)})`},AgvcTagClickHandle(e){this.$router.push({name:"agvc",query:{agv_id:e}})}},computed:{SelectedOrderTaskData(){var e=this.OrderList.find((e=>e.OrderNo==this.SelectOrderNO));return e?e.TaskDownloadData:{}},SelectedOrderTaskData_LAT(){var e=this.OrderList.find((e=>e.OrderNo==this.SelectOrderNO));return e?e.latOrderDetail:{}}},mounted(){setTimeout((()=>{this.FetchOrderList().then((()=>{this.SubscribeOrderChange()}))}),10)}};const tt=(0,m.Z)(et,[["render",Ye]]);var at=tt;const st=e=>((0,n.dD)("data-v-1477f57b"),e=e(),(0,n.Cn)(),e),nt={class:"agvc-view bg-light"},rt={class:"w-100 mx-2 py-2 text-end border-bottom"},ot=(0,n.Uk)("MAP"),lt=(0,n.Uk)("原廠資訊"),it={class:"infos d-flex flex-row row border-bottom"},ct={class:"info-block"},dt=st((()=>(0,n._)("h5",null,"ID",-1))),ut={class:"content"},gt={class:"info-block"},mt=st((()=>(0,n._)("h5",null,"名稱",-1))),vt={class:"content"},pt={class:"info-block"},ht=st((()=>(0,n._)("h5",null,"廠牌",-1))),ft={class:"content"},wt={class:"info-block"},_t=st((()=>(0,n._)("h5",null,"連線狀態",-1))),bt={class:"content"},yt={class:"info-block"},kt=st((()=>(0,n._)("h5",null,"上線狀態",-1))),jt={class:"content"},St={class:"info-block"},Dt=st((()=>(0,n._)("h5",null,"訂單狀態",-1))),Ct={class:"content"},Ot={class:"info-block"},xt=st((()=>(0,n._)("h5",null,"電量",-1))),At={class:"content"},Wt={class:"my-2 mx-2 order-block"},It={class:"order-card-title"},zt=st((()=>(0,n._)("h5",null,"Orders",-1))),Tt=(0,n.Uk)("檢視所有訂單");function Vt(e,t,a,r,o,l){const i=(0,n.up)("side-menu"),c=(0,n.up)("el-button"),d=(0,n.up)("el-progress"),u=(0,n.up)("el-table-column"),g=(0,n.up)("el-table"),m=(0,n.up)("native-info-viewer"),v=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",nt,[(0,n.Wm)(i,{ref:"side_menu",listData:o.agvcList,onCollapseChange:t[0]||(t[0]=e=>{o.menu_show=!e})},null,8,["listData"]),(0,n._)("div",{class:(0,V.C_)(["w-100",o.menu_show?"menu-show":"menu-hide"])},[(0,n._)("div",rt,[(0,n.Wm)(c,{class:"mx-1",type:"",size:"default",onClick:t[1]||(t[1]=()=>{e.$router.push({name:"map",params:{agv_id:o.selectedAgvcID}})})},{default:(0,n.w5)((()=>[ot])),_:1}),(0,n.Wm)(c,{class:"mx-1",type:"",size:"default",onClick:l.ShowNativeInfo},{default:(0,n.w5)((()=>[lt])),_:1},8,["onClick"])]),(0,n._)("div",it,[(0,n._)("div",ct,[dt,(0,n._)("div",ut,(0,V.zw)(l.agv_id),1)]),(0,n._)("div",gt,[mt,(0,n._)("div",vt,(0,V.zw)(l.agv_eqName),1)]),(0,n._)("div",pt,[ht,(0,n._)("div",ft,(0,V.zw)(l.agv_type),1)]),(0,n._)("div",wt,[_t,(0,n._)("div",bt,(0,V.zw)(l.agv_ConnectedState),1)]),(0,n._)("div",yt,[kt,(0,n._)("div",jt,(0,V.zw)(l.agv_OnlineState),1)]),(0,n._)("div",St,[Dt,(0,n._)("div",Ct,(0,V.zw)(l.agv_RunningState),1)]),(0,n._)("div",Ot,[xt,(0,n._)("div",At,[(0,n.Wm)(d,{percentage:l.agv_battery,type:"circle",width:60},null,8,["percentage"])])])]),(0,n._)("div",Wt,[(0,n._)("div",It,[zt,(0,n.Wm)(c,{type:"",size:"default",onClick:t[2]||(t[2]=()=>{e.$router.push("/Orders")})},{default:(0,n.w5)((()=>[Tt])),_:1})]),(0,n.Wm)(g,{data:l.agv_orderList,"row-key":"OrderNo",height:"430",border:""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{label:"任務名",prop:"latOrderDetail.taskName"}),(0,n.Wm)(u,{label:"派車廠商",prop:"FromAGVS.agvsType",formatter:l.AGVSTypeFormat},null,8,["formatter"]),(0,n.Wm)(u,{label:"接收時間",prop:"RecieveTimeStamp",formatter:l.TimeFormatter},null,8,["formatter"]),(0,n.Wm)(u,{label:"完成時間",prop:"CompleteTimeStamp",formatter:l.TimeFormatter},null,8,["formatter"]),(0,n.Wm)(u,{label:"執行狀態",prop:"State",formatter:l.OrderStateFormat},null,8,["formatter"])])),_:1},8,["data"])])],2),(0,n.wy)((0,n._)("div",{class:(0,V.C_)(["foot py-2",o.menu_show?"menu-show":"menu-hide"])},"?sdasasasasasasasasasasas",2),[[s.F8,!1]]),(0,n.Wm)(m,{agv_id:o.selectedAgvcID,agv_name:l.agv_eqName,ref:"native_info_viewer"},null,8,["agv_id","agv_name"])])),[[v,o.loading]])}const Nt=["id"],Lt=(0,n._)("div",{class:"bg-light h-100"},"???",-1);function Gt(e,t,a,s,r,o){const l=(0,n.up)("el-drawer");return(0,n.wg)(),(0,n.j4)(l,{modelValue:r.draw_show,"onUpdate:modelValue":t[0]||(t[0]=e=>r.draw_show=e),direction:r.direction,size:"50%"},{header:(0,n.w5)((({titleId:e})=>[(0,n._)("div",{class:"text-start",id:e},[(0,n._)("h3",null,(0,V.zw)(a.agv_name)+"("+(0,V.zw)(a.agv_id)+")",1)],8,Nt)])),default:(0,n.w5)((()=>[Lt])),_:1},8,["modelValue","direction"])}var Ft={props:{agv_id:{type:String,default:""},agv_name:{type:String,default:""}},data(){return{draw_show:!1,direction:"rtl"}},methods:{Open(){this.direction=window.innerWidth>500?"rtl":"btt",this.draw_show=!0}},mounted(){this.direction=window.innerWidth>500?"rtl":"btt"}};const Ut=(0,m.Z)(Ft,[["render",Gt]]);var Pt=Ut;const Ht=(0,n._)("i",{class:"bi bi-list"},null,-1),Et=[Ht],Mt=(0,n._)("i",{class:"bi bi-arrow-left"},null,-1),$t=[Mt],Rt={class:"sidebar h-100 my-2"},qt={class:"title text-start w-100 px-3 py-2"},Kt={class:"selector-mode"},Zt={class:"menu-mode border-top h-100"},Bt={class:"d-flex flex-column"},Qt=["index","onClick"],Yt=["onClick"],Jt=(0,n._)("i",{class:"bi bi-car-front"},null,-1);function Xt(e,t,a,r,o,l){const i=(0,n.up)("el-option"),c=(0,n.up)("el-select");return(0,n.wg)(),(0,n.iD)("div",{class:(0,V.C_)(["agvc-side-menu h-100",o.isCollapse?"hidding":""])},[(0,n._)("div",{class:(0,V.C_)(["toggle",o.isCollapse?"hidding":""])},[o.isCollapse?((0,n.wg)(),(0,n.iD)("span",{key:0,class:"mx-3 py-2",onClick:t[0]||(t[0]=e=>l.Show())},Et)):((0,n.wg)(),(0,n.iD)("span",{key:1,class:"mx-3 py-2",onClick:t[1]||(t[1]=e=>l.Hide())},$t))],2),(0,n.Wm)(s.uT,{name:"el-fade-in"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("div",Rt,[(0,n._)("div",qt,(0,V.zw)(a.menu_title),1),(0,n.wy)((0,n._)("div",Kt,[(0,n.Wm)(c,{size:"large",modelValue:o.selectedAgvcID,"onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedAgvcID=e),onChange:l.ChangeAGVC},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.listData,(e=>((0,n.wg)(),(0,n.j4)(i,{key:e.Key,label:`${e.Key}(${e.Value.EQName})`,value:e.Key},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])],512),[[s.F8,!1]]),(0,n._)("div",Zt,[(0,n._)("div",Bt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.listData,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,V.C_)([e.Key==o.selectedAgvcID?"active":"inactive","item text-start w-100"]),key:e.Key,index:e.Value,onClick:t=>l.ChangeAGVC(e.Key)},[(0,n._)("a",{class:(0,V.C_)(["",e.Key==o.selectedAgvcID?"a-active":"a-inactive"]),onClick:t=>l.ChangeAGVC(e.Key)},[Jt,(0,n.Uk)(" "+(0,V.zw)(e.Value.EQName)+" | ("+(0,V.zw)(e.Value.Type)+") ",1)],10,Yt)],10,Qt)))),128))])])],512),[[s.F8,!o.isCollapse]])])),_:1})],2)}var ea={props:{listData:{type:Array,default:[]},menu_title:{type:String,default:"AGVC List"}},data(){return{isCollapse:!1,position:"left",selectedAgvcID:""}},methods:{Hide(){this.isCollapse=!0,this.$emit("collapseChange",!0)},Show(){this.isCollapse=!1,this.$emit("collapseChange",!1)},GetCollapseState(){return this.isCollapse},ChangeAGVC(e){this.loading=!0,this.selectedAgvcID=e,this.$router.push({name:"agvc",query:{agv_id:e}}),setTimeout((()=>{this.loading=!1}),400)}},mounted(){this.$route.query.agv_id?this.selectedAgvcID=this.$route.query.agv_id:0!=this.listData.length&&(this.selectedAgvcID=this.listData[0].Key)}};const ta=(0,m.Z)(ea,[["render",Xt]]);var aa=ta,sa={components:{"native-info-viewer":Pt,"side-menu":aa},data(){return{loading:!0,id:1,agvcData:null,agvcList:[],selectedAgvcID:"",menu_show:!0}},methods:{OrderStateFormat(e,t,a,s){return ne(a)},AGVSTypeFormat(e,t,a,s){return te(a)},TimeFormatter(e,t,a,s){return Xe()(a).format("yyyy-MM-DD HH:mm:ss")},ShowNativeInfo(){this.$refs.native_info_viewer.Open()}},mounted(){setTimeout((()=>{O().then((e=>{this.agvcList=e,this.selectedAgvcID=this.agv_id})),A(this.agv_id).then((e=>this.agvcData=e)),setInterval((async()=>{this.loading=!1,this.agvcData=await A(this.agv_id)}),1e3)}),400)},computed:{agv_id(){var e=this.$route.query;return e.agv_id?e.agv_id:0!=this.agvcList.length?this.agvcList[0].Key:"??"},agv_type(){return this.agvcData?ee(this.agvcData.agvcType):"-"},agv_OnlineState(){return this.agvcData?this.agvcData.agvcStates.States.OnlineState:"-"},agv_RunningState(){return this.agvcData?this.agvcData.agvcStates.States.RunningState:"-"},agv_ConnectedState(){return this.agvcData?this.agvcData.agvcStates.States.ConnectionState:"-"},agv_battery(){return this.agvcData?this.agvcData.agvcStates.BetteryState.remaining:-1},agv_eqName(){return this.agvcData?this.agvcData.EQName:-1},agv_orderList(){return this.agvcData&&this.agvcData.orderList_LAT?this.agvcData.orderList_LAT:[]}}};const na=(0,m.Z)(sa,[["render",Vt],["__scopeId","data-v-1477f57b"]]);var ra=na;const oa={class:"log-view my-5 border"},la={class:"fix-in-bottom"};function ia(e,t,a,s,r,o){const l=(0,n.up)("log-item");return(0,n.wg)(),(0,n.iD)("div",oa,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.logItemList,(e=>((0,n.wg)(),(0,n.j4)(l,{key:e.Time,logItem:e},null,8,["logItem"])))),128)),(0,n._)("div",la,[(0,n.Wm)(l,{logItem:o.newestlog},null,8,["logItem"])])])}a(2262),a(1378);const ca={class:"log-item d-flex flex-row border-bottom"},da={style:{color:"white"}},ua={class:"msg px-2 text-start"};function ga(e,t,a,s,r,o){const l=(0,n.up)("el-tag");return(0,n.wg)(),(0,n.iD)("div",ca,[(0,n._)("div",null,[(0,n.Wm)(l,{effect:"light",type:"info","disable-transitions":""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(o.time),1)])),_:1})]),(0,n._)("div",da,[(0,n.Wm)(l,{effect:"dark",type:"AGVS_TO_LAT"==a.logItem.Direction?"danger":"success","disable-transitions":""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,V.zw)(a.logItem.Direction),1)])),_:1},8,["type"])]),(0,n._)("div",ua,(0,V.zw)(o.shortMsg),1)])}var ma={props:{logItem:{type:Object,default:{Direction:"",Time:"",Message:""}}},computed:{time(){return Xe()(this.logItem.Time).format("yyyy-MM-DD HH:mm:ss")},shortMsg(){var e=window.innerWidth;return console.info(e),this.logItem.Message.substring(0,e-650)+"..."}}};const va=(0,m.Z)(ma,[["render",ga],["__scopeId","data-v-ee8e7c3a"]]);var pa=va,ha={components:{"log-item":pa},data(){return{logItemList:[]}},methods:{WebsocketConnect(){var e=new WebSocket(this.wsHost+"/messageHsLog");e.onopen=()=>console.info("log ws connected"),e.onmessage=e=>{this.WsDataHandle(JSON.parse(e.data))}},WsDataHandle(e){this.logItemList.length>100&&(this.logItemList=[]),this.logItemList.push(e)}},mounted(){console.info("ws host:",this.wsHost),this.WebsocketConnect()},computed:{wsHost(){return C.replaceAll("http","ws")},newestlog(){return this.logItemList.at(this.logItemList.length-1)}}};const fa=(0,m.Z)(ha,[["render",ia],["__scopeId","data-v-36d58213"]]);var wa=fa;const _a=[{path:"/",name:"home",component:de},{path:"/Orders",name:"orders",component:at},{path:"/map/:agv_id",name:"map",component:Ve},{path:"/map_all",name:"map_all",component:Ve},{path:"/agvc",name:"agvc",component:ra},{path:"/log",name:"log",component:wa}],ba=(0,w.p7)({history:(0,w.PO)("/"),routes:_a});var ya=ba,ka=a(2026),ja=a(2918),Sa=(a(4415),a(8865)),Da=a.n(Sa);const Ca=(0,s.ri)(h);Ca.use(ya),Ca.use(Da()),Ca.use(ka.ZP),Ca.use(ja.Z,{size:"default",zIndex:3e3}),Ca.mount("#app")}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,r){if(!s){var o=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],r=e[d][2];for(var l=!0,i=0;i<s.length;i++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](s[i])}))?s.splice(i--,1):(l=!1,r<o&&(o=r));if(l){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,n,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={826:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,r,o=s[0],l=s[1],i=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(i)var d=i(a)}for(t&&t(s);c<o.length;c++)r=o[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},s=self["webpackChunkgpm_agv_lat_web"]=self["webpackChunkgpm_agv_lat_web"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(4285)}));s=a.O(s)})();
//# sourceMappingURL=index.7a65a712.js.map